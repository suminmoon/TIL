{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "# pandas : python의 data analysis의 핵심 라이브러리\n",
    "# pandas는 고유하게 정의된 두 개의 자료구조를 이용\n",
    "# Series : numpy의 1차원 배열과 유사\n",
    "#          같은 데이터 타입을 가진다.\n",
    "# DataFrame : numpy의 2차원 배열과 유사"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>names</th>\n",
       "      <th>points</th>\n",
       "      <th>year</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>kim</td>\n",
       "      <td>1.5</td>\n",
       "      <td>2015</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>lee</td>\n",
       "      <td>2.3</td>\n",
       "      <td>2016</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>park</td>\n",
       "      <td>4.0</td>\n",
       "      <td>2017</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>lee</td>\n",
       "      <td>4.5</td>\n",
       "      <td>2015</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>kim</td>\n",
       "      <td>3.4</td>\n",
       "      <td>2019</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  names  points  year\n",
       "0   kim     1.5  2015\n",
       "1   lee     2.3  2016\n",
       "2  park     4.0  2017\n",
       "3   lee     4.5  2015\n",
       "4   kim     3.4  2019"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "RangeIndex(start=0, stop=5, step=1)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "15"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# DataFrame : 가장 흔하게 사용하는 자료구조\n",
    "# 2차원 배열, 행과 열로 구성되어 있는 Table형태의 자료형\n",
    "# DataFrame 생성( dictionary를 이용해서 )\n",
    "# value 값에 list로 넣을 수 있음\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "# 각 value의 개수가 같아야 함!!\n",
    "data = { \"names\" : [\"kim\",\"lee\",\"park\",\"lee\",\"kim\"] ,\n",
    "         \"year\" : [2015,2016,2017,2015,2019] ,\n",
    "       \"points\" : [1.5,2.3,4.0,4.5,3.4] }\n",
    "df = pd.DataFrame(data)\n",
    "display(df)\n",
    "print(df.index)     # DataFrame의 index 정보\n",
    "df.values    # DataFrame이 가지고 있는 값만 \n",
    "#              numpy array 2차 배열로 뽑아내기\n",
    "df.ndim      # 2차원\n",
    "df.shape     # 형태 (5,3) 5행 3열\n",
    "df.size      # 전체 요소의 개수 15\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>names</th>\n",
       "      <th>points</th>\n",
       "      <th>year</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>kim</td>\n",
       "      <td>1.5</td>\n",
       "      <td>2015</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>lee</td>\n",
       "      <td>2.3</td>\n",
       "      <td>2016</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>park</td>\n",
       "      <td>4.0</td>\n",
       "      <td>2017</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>lee</td>\n",
       "      <td>4.5</td>\n",
       "      <td>2015</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>kim</td>\n",
       "      <td>3.4</td>\n",
       "      <td>2019</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  names  points  year\n",
       "0   kim     1.5  2015\n",
       "1   lee     2.3  2016\n",
       "2  park     4.0  2017\n",
       "3   lee     4.5  2015\n",
       "4   kim     3.4  2019"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>학생정보</th>\n",
       "      <th>names</th>\n",
       "      <th>points</th>\n",
       "      <th>year</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>학생순번</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>kim</td>\n",
       "      <td>1.5</td>\n",
       "      <td>2015</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>lee</td>\n",
       "      <td>2.3</td>\n",
       "      <td>2016</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>park</td>\n",
       "      <td>4.0</td>\n",
       "      <td>2017</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>lee</td>\n",
       "      <td>4.5</td>\n",
       "      <td>2015</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>kim</td>\n",
       "      <td>3.4</td>\n",
       "      <td>2019</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "학생정보 names  points  year\n",
       "학생순번                    \n",
       "0      kim     1.5  2015\n",
       "1      lee     2.3  2016\n",
       "2     park     4.0  2017\n",
       "3      lee     4.5  2015\n",
       "4      kim     3.4  2019"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "# 각 value의 개수가 같아야 함!!\n",
    "data = { \"names\" : [\"kim\",\"lee\",\"park\",\"lee\",\"kim\"] ,\n",
    "         \"year\" : [2015,2016,2017,2015,2019] ,\n",
    "       \"points\" : [1.5,2.3,4.0,4.5,3.4] }\n",
    "df = pd.DataFrame(data)\n",
    "\n",
    "# column에 대한 정보도 확인이 가능\n",
    "display(df)\n",
    "df.columns   # column에 대한 정보를 알려준다.\n",
    "df.index.name = \"학생순번\"\n",
    "df.columns.name = \"학생정보\"\n",
    "display(df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# 일반적으로 데이터를 주고받기 위해서 데이터를 표현하는 표준\n",
    "# 1. csv방식 (comma seperated value)\n",
    "#   - \",\"를 기준으로 데이터를 분리해서 표현하는 방식\n",
    "#    예) 10,홍길동,서울,20,김길동,인천,30,최길동,40...\n",
    "#    장점 : 부가적인 데이터가 상대적으로 작다.\n",
    "#          많은 양의 데이터를 표현하기에 적합\n",
    "#    단점 : 데이터 핸들링이 쉽지 않다.\n",
    "\n",
    "# 2. XML방식 (Extended Markup Language)\n",
    "#    예) <person><age>10</age><name>홍길동</name>\n",
    "#        <address>서울</address></person>\n",
    "#    장점: 유지보수성이 높다.\n",
    "#    단점: 부가적인 데이터가 많다.\n",
    "\n",
    "# 3. JSON (JavaScript Object Notation)\n",
    "#    예) { age : 10, name : 홍길동, address : 서울 }\n",
    "#    장점 : 유지보수성이 높다.\n",
    "#          XML보다 데이터 크기가 작다."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(9742, 3)"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# csv 파일로부터 데이터를 읽어서 DataFrame을 생성\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "#df = pd.read_csv(\"./data/sample/student.csv\")\n",
    "df = pd.read_csv(\"./data/movie/movies.csv\")\n",
    "df.head()     # 앞에서 5만 추출\n",
    "df.tail()     # 뒤에서 5개만 추출\n",
    "df.shape   # 일반적으로 전체 row가 몇 개인지 확인\n",
    "# np.loadtxt(\"./data/movie/movies.csv\", delimiter=\",\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Pandas\n",
    "# 1.Series\n",
    "#  - Numpy 1차원 array와 유사\n",
    "#  - index를 Series 자체에 저장\n",
    "#  - 기본적인 숫자 index (0 ~ )를 사용할 수 있다.\n",
    "# 2. DataFrame\n",
    "#  - 여러개의 Series를 모아놓은 Table형식의 자료구조"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>이름</th>\n",
       "      <th>평점</th>\n",
       "      <th>학과</th>\n",
       "      <th>학년</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>이지안</td>\n",
       "      <td>3.4</td>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>박동훈</td>\n",
       "      <td>2.4</td>\n",
       "      <td>철학</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>문수민</td>\n",
       "      <td>4.5</td>\n",
       "      <td>산공</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    이름   평점   학과  학년\n",
       "0  이지안  3.4  컴퓨터   1\n",
       "1  박동훈  2.4   철학   2\n",
       "2  문수민  4.5   산공   3"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Dictionary를 이용한 DataFrame 생성\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "#my_dict = dict()    #empty dictionary 생성\n",
    "#my_dict = {}\n",
    "#my_dict = {\"key\" : \"value\"}    #dictionary\n",
    "#my_dict = {1, 2, 3, 4}        #set\n",
    "\n",
    "#학생 정보 dictionary (이름, 학과, 학년, 평점 )\n",
    "my_dict = { \"이름\" : [\"이지안\",\"박동훈\",\"문수민\"] ,\n",
    "           \"학과\" : [\"컴퓨터\",\"철학\",\"산공\"] ,\n",
    "           \"학년\" : [1,2,3] ,\n",
    "           \"평점\" : [3.4,2.4,4.5] }    \n",
    "# my_dict[\"학과\"][1]    '철학'\n",
    "df = pd.DataFrame(my_dict)\n",
    "df\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "키워드를 입력하세요java\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>bisbn</th>\n",
       "      <th>btitle</th>\n",
       "      <th>bauthor</th>\n",
       "      <th>bprice</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>89-7914-371-0</td>\n",
       "      <td>Head First Java: 뇌 회로를 자극하는 자바 학습법(개정판)</td>\n",
       "      <td>케이시 시에라,버트 베이츠</td>\n",
       "      <td>28000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>89-7914-397-4</td>\n",
       "      <td>뇌를 자극하는 Java 프로그래밍</td>\n",
       "      <td>김윤명</td>\n",
       "      <td>27000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>978-89-6848-042-3</td>\n",
       "      <td>모던 웹을 위한 JavaScript + jQuery 입문(개정판) : 자바스크립트에...</td>\n",
       "      <td>윤인성</td>\n",
       "      <td>32000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>978-89-6848-132-1</td>\n",
       "      <td>JavaScript+jQuery 정복 : 보고, 이해하고, 바로 쓰는 자바스크립트 공략집</td>\n",
       "      <td>김상형</td>\n",
       "      <td>28000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>978-89-6848-147-5</td>\n",
       "      <td>이것이 자바다 : 신용권의 Java 프로그래밍 정복</td>\n",
       "      <td>신용권</td>\n",
       "      <td>30000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>978-89-6848-156-7</td>\n",
       "      <td>Head First JavaScript Programming : 게임과 퍼즐로 배우...</td>\n",
       "      <td>에릭 프리먼, 엘리자베스 롭슨</td>\n",
       "      <td>36000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>978-89-7914-582-3</td>\n",
       "      <td>Head First JavaScript : 대화형 웹 애플리케이션의 시작</td>\n",
       "      <td>마이클 모리슨</td>\n",
       "      <td>28000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>978-89-7914-659-2</td>\n",
       "      <td>UML과 JAVA로 배우는 객체지향 CBD 실전 프로젝트 : 도서 관리 시스템</td>\n",
       "      <td>채흥석</td>\n",
       "      <td>40000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>978-89-7914-832-9</td>\n",
       "      <td>IT CookBook, 웹 프로그래밍 입문 : XHTML, CSS2, JavaScript</td>\n",
       "      <td>김형철, 안치현</td>\n",
       "      <td>23000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>978-89-7914-855-8</td>\n",
       "      <td>자바스크립트 성능 최적화: High Performance JavaScript</td>\n",
       "      <td>니콜라스 자카스</td>\n",
       "      <td>20000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>978-89-98756-79-6</td>\n",
       "      <td>IT CookBook, Java for Beginner</td>\n",
       "      <td>황희정, 강운구</td>\n",
       "      <td>23000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>978-89-98756-89-5</td>\n",
       "      <td>IT CookBook, 인터넷 프로그래밍 입문: HTML, CSS, JavaScript</td>\n",
       "      <td>주성례(저자), 정선호(저자), 한민형(저자), 권원상</td>\n",
       "      <td>22000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                bisbn                                             btitle  \\\n",
       "0       89-7914-371-0            Head First Java: 뇌 회로를 자극하는 자바 학습법(개정판)   \n",
       "1       89-7914-397-4                                 뇌를 자극하는 Java 프로그래밍   \n",
       "2   978-89-6848-042-3  모던 웹을 위한 JavaScript + jQuery 입문(개정판) : 자바스크립트에...   \n",
       "3   978-89-6848-132-1  JavaScript+jQuery 정복 : 보고, 이해하고, 바로 쓰는 자바스크립트 공략집   \n",
       "4   978-89-6848-147-5                       이것이 자바다 : 신용권의 Java 프로그래밍 정복   \n",
       "5   978-89-6848-156-7  Head First JavaScript Programming : 게임과 퍼즐로 배우...   \n",
       "6   978-89-7914-582-3           Head First JavaScript : 대화형 웹 애플리케이션의 시작   \n",
       "7   978-89-7914-659-2        UML과 JAVA로 배우는 객체지향 CBD 실전 프로젝트 : 도서 관리 시스템   \n",
       "8   978-89-7914-832-9  IT CookBook, 웹 프로그래밍 입문 : XHTML, CSS2, JavaScript   \n",
       "9   978-89-7914-855-8         자바스크립트 성능 최적화: High Performance JavaScript   \n",
       "10  978-89-98756-79-6                     IT CookBook, Java for Beginner   \n",
       "11  978-89-98756-89-5   IT CookBook, 인터넷 프로그래밍 입문: HTML, CSS, JavaScript   \n",
       "\n",
       "                           bauthor  bprice  \n",
       "0                   케이시 시에라,버트 베이츠   28000  \n",
       "1                              김윤명   27000  \n",
       "2                              윤인성   32000  \n",
       "3                              김상형   28000  \n",
       "4                              신용권   30000  \n",
       "5                 에릭 프리먼, 엘리자베스 롭슨   36000  \n",
       "6                          마이클 모리슨   28000  \n",
       "7                              채흥석   40000  \n",
       "8                         김형철, 안치현   23000  \n",
       "9                         니콜라스 자카스   20000  \n",
       "10                        황희정, 강운구   23000  \n",
       "11  주성례(저자), 정선호(저자), 한민형(저자), 권원상   22000  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Database로부터 Data를 읽어서 DataFrame으로 생성\n",
    "# mysql database를 이용\n",
    "# pymysql module 이용\n",
    "import pymysql.cursors\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "# mysql, oracle, DB2, infomix, cybase : DBMS\n",
    "# Database : 데이터의 논리적인 집합\n",
    "conn = pymysql.connect(host=\"localhost\" ,   #mysql이 설치된 컴퓨터의 ip\n",
    "               user = \"python\" ,     #사용자 계정 id\n",
    "               password = \"python\",  #사용자 pwd \n",
    "               db = \"library\",       #사용할 database\n",
    "               charset = \"utf8\" )\n",
    "\n",
    "# SQL을 작성\n",
    "# 제공한 script 파일에 books라는 table이 있다.\n",
    "keyword = input(\"키워드를 입력하세요\")    # %java% java라를 문자를 포함한 데이터 모두 가져오기\n",
    "sql = \"SELECT bisbn,btitle,bauthor,bprice \\\n",
    "           FROM books WHERE btitle LIKE '%{}%'\".format(keyword)\n",
    "# pandas가 sql을 실행시켜서 그 결과를 DataFrame으로 생성 (read_sql)\n",
    "df = pd.read_sql( sql, con = conn )\n",
    "display(df)\n",
    "conn.close()    #Database 연결 종료!!!!!!!!!\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "키워드를 입력하세요java\n"
     ]
    }
   ],
   "source": [
    "# 이렇게 database로부터 얻어낸 data를 DataFrame으로 만들었는데\n",
    "# JSON 형태로 파일에 저장\n",
    "\n",
    "import pymysql.cursors\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "# mysql, oracle, DB2, infomix, cybase : DBMS\n",
    "# Database : 데이터의 논리적인 집합\n",
    "conn = pymysql.connect(host=\"localhost\" ,   #mysql이 설치된 컴퓨터의 ip\n",
    "               user = \"python\" ,     #사용자 계정 id\n",
    "               password = \"python\",  #사용자 pwd \n",
    "               db = \"library\",       #사용할 database\n",
    "               charset = \"utf8\" )\n",
    "\n",
    "# SQL을 작성\n",
    "# 제공한 script 파일에 books라는 table이 있다.\n",
    "keyword = input(\"키워드를 입력하세요\")    # %java% java라를 문자를 포함한 데이터 모두 가져오기\n",
    "sql = \"SELECT bisbn,btitle,bauthor,bprice \\\n",
    "           FROM books WHERE btitle LIKE '%{}%'\".format(keyword)\n",
    "# pandas가 sql을 실행시켜서 그 결과를 DataFrame으로 생성 (read_sql)\n",
    "df = pd.read_sql( sql, con = conn )\n",
    "df.to_json(\"./data/sample/books.json\")   #json형태로 파일 저장\n",
    "conn.close()    #Database 연결 종료!!!!!!!!!\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# JSON file로부터 데이터를 읽어서 dictionary로 만든다.\n",
    "# JSON이라는 데이터 표현형태는 python의 dictionary와 같은 형태를 갖는다.\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "import json\n",
    "\n",
    "# 일단 python의 파일처리기능을 이용해서 file을 열고 \n",
    "# 데이터를 읽어들인다.\n",
    "#                                        \"r\" : 읽을 용도로 가져오겠다.\n",
    "file = open(\"./data/sample/books.json\" , \"r\")\n",
    "\n",
    "my_dict=json.load(file)\n",
    "file.close()\n",
    "\n",
    "\n",
    "for tmp in my_dict[\"btitle\"].values():\n",
    "    print(tmp)    #json 파일 읽어온 후 btitle의 value (내용)만 읽어오기\n",
    "df = pd.DataFrame(my_dict)\n",
    "display(df)\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "metadata": {},
   "outputs": [
    {
     "ename": "TypeError",
     "evalue": "the JSON object must be str, not 'bytes'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mTypeError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[1;32m<ipython-input-45-e6d3341c859e>\u001b[0m in \u001b[0;36m<module>\u001b[1;34m()\u001b[0m\n\u001b[0;32m     12\u001b[0m \u001b[0mmovie_page\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0murllib\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mrequest\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0murlopen\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mstr\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mmovie_url\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     13\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m---> 14\u001b[1;33m \u001b[0mjson_page\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mjson\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mloads\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mmovie_page\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mread\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m     15\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     16\u001b[0m \u001b[1;31m# json_page\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\Anaconda3\\envs\\asus_env\\lib\\json\\__init__.py\u001b[0m in \u001b[0;36mloads\u001b[1;34m(s, encoding, cls, object_hook, parse_float, parse_int, parse_constant, object_pairs_hook, **kw)\u001b[0m\n\u001b[0;32m    310\u001b[0m     \u001b[1;32mif\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[0misinstance\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0ms\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mstr\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    311\u001b[0m         raise TypeError('the JSON object must be str, not {!r}'.format(\n\u001b[1;32m--> 312\u001b[1;33m                             s.__class__.__name__))\n\u001b[0m\u001b[0;32m    313\u001b[0m     \u001b[1;32mif\u001b[0m \u001b[0ms\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mstartswith\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34mu'\\ufeff'\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    314\u001b[0m         raise JSONDecodeError(\"Unexpected UTF-8 BOM (decode using utf-8-sig)\",\n",
      "\u001b[1;31mTypeError\u001b[0m: the JSON object must be str, not 'bytes'"
     ]
    }
   ],
   "source": [
    "# open API를 이용해서 JSON data를 받은 다음\n",
    "# 해당 data를 처리해서 DataFrame으로 생성해보자.\n",
    "###############오류!!!!!!!!!!!!!!!!!!!!!!!!####################\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "import urllib       #외부 url 호출\n",
    "import json\n",
    "\n",
    "day = \"20190219\"\n",
    "movie_url = \"http://www.kobis.or.kr/kobisopenapi/webservice/rest/boxoffice/searchDailyBoxOfficeList.json?key=430156241533f1d058c603178cc3ca0e&targetDt=20120101\"\n",
    "\n",
    "movie_page = urllib.request.urlopen(movie_url)\n",
    "\n",
    "json_page = json.loads(movie_page.read())\n",
    "\n",
    "# json_page\n",
    "# json_page : Dictionary\n",
    "# 박스오피스 순위 : index\n",
    "# 제목, 당일매출액 : column\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>학과</th>\n",
       "      <th>이름</th>\n",
       "      <th>학점</th>\n",
       "      <th>학년</th>\n",
       "      <th>등급</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>one</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>이지안</td>\n",
       "      <td>2.5</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>two</th>\n",
       "      <td>기계</td>\n",
       "      <td>박동훈</td>\n",
       "      <td>3.6</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>three</th>\n",
       "      <td>철학</td>\n",
       "      <td>홍길동</td>\n",
       "      <td>4.3</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>four</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>강감찬</td>\n",
       "      <td>3.8</td>\n",
       "      <td>4</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        학과   이름   학점  학년   등급\n",
       "one    컴퓨터  이지안  2.5   1  NaN\n",
       "two     기계  박동훈  3.6   1  NaN\n",
       "three   철학  홍길동  4.3   2  NaN\n",
       "four   컴퓨터  강감찬  3.8   4  NaN"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# DataFrame의 index와 column을 재정의 하려면 어떻게 해야 할까?\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "data = { \"이름\" : [\"이지안\",\"박동훈\",\"홍길동\",\"강감찬\"],\n",
    "          \"학과\" : [\"컴퓨터\",\"기계\",\"철학\",\"컴퓨터\"],\n",
    "          \"학년\": [1,1,2,4],\n",
    "          \"학점\" : [2.5,3.6,4.3,3.8] }\n",
    "df = pd.DataFrame(data,     #column의 순서 지정 , index 재정의\n",
    "                 columns = [\"학과\", \"이름\", \"학점\", \"학년\", \"등급\"] ,\n",
    "                 index = [\"one\", \"two\", \"three\", \"four\"])\n",
    "df                                                                                                                                                                                                                                                                                   "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>학점</th>\n",
       "      <th>학년</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>4.000000</td>\n",
       "      <td>4.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>3.550000</td>\n",
       "      <td>2.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>0.759386</td>\n",
       "      <td>1.414214</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>2.500000</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>3.325000</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>3.700000</td>\n",
       "      <td>1.500000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>3.925000</td>\n",
       "      <td>2.500000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>4.300000</td>\n",
       "      <td>4.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "             학점        학년\n",
       "count  4.000000  4.000000\n",
       "mean   3.550000  2.000000\n",
       "std    0.759386  1.414214\n",
       "min    2.500000  1.000000\n",
       "25%    3.325000  1.000000\n",
       "50%    3.700000  1.500000\n",
       "75%    3.925000  2.500000\n",
       "max    4.300000  4.000000"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# DataFrame은 기본 분석 함수를 가지고 있다.\n",
    "\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "data = { \"이름\" : [\"이지안\",\"박동훈\",\"홍길동\",\"강감찬\"],\n",
    "          \"학과\" : [\"컴퓨터\",\"기계\",\"철학\",\"컴퓨터\"],\n",
    "          \"학년\": [1,1,2,4],\n",
    "          \"학점\" : [2.5,3.6,4.3,3.8] }\n",
    "df = pd.DataFrame(data,     #column의 순서 지정 , index 재정의\n",
    "                 columns = [\"학과\", \"이름\", \"학점\", \"학년\", \"등급\"] ,\n",
    "                 index = [\"one\", \"two\", \"three\", \"four\"])\n",
    "# DataFrame에 대한 기본 집계함수를 실행해서 결과를 출력\n",
    "df.describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>학과</th>\n",
       "      <th>이름</th>\n",
       "      <th>학점</th>\n",
       "      <th>학년</th>\n",
       "      <th>등급</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>one</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>이지안</td>\n",
       "      <td>2.5</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>two</th>\n",
       "      <td>기계</td>\n",
       "      <td>박동훈</td>\n",
       "      <td>3.6</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>three</th>\n",
       "      <td>철학</td>\n",
       "      <td>홍길동</td>\n",
       "      <td>4.3</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>four</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>강감찬</td>\n",
       "      <td>3.8</td>\n",
       "      <td>4</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        학과   이름   학점  학년   등급\n",
       "one    컴퓨터  이지안  2.5   1  NaN\n",
       "two     기계  박동훈  3.6   1  NaN\n",
       "three   철학  홍길동  4.3   2  NaN\n",
       "four   컴퓨터  강감찬  3.8   4  NaN"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>학과</th>\n",
       "      <th>학점</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>one</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>2.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>two</th>\n",
       "      <td>기계</td>\n",
       "      <td>3.6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>three</th>\n",
       "      <td>철학</td>\n",
       "      <td>4.3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>four</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>3.8</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        학과   학점\n",
       "one    컴퓨터  2.5\n",
       "two     기계  3.6\n",
       "three   철학  4.3\n",
       "four   컴퓨터  3.8"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# 특정 column을 선택하려면 어떻게 해야 할까?\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "data = { \"이름\" : [\"이지안\",\"박동훈\",\"홍길동\",\"강감찬\"],\n",
    "          \"학과\" : [\"컴퓨터\",\"기계\",\"철학\",\"컴퓨터\"],\n",
    "          \"학년\": [1,1,2,4],\n",
    "          \"학점\" : [2.5,3.6,4.3,3.8] }\n",
    "df = pd.DataFrame(data,     #column의 순서 지정 , index 재정의\n",
    "                 columns = [\"학과\", \"이름\", \"학점\", \"학년\", \"등급\"] ,\n",
    "                 index = [\"one\", \"two\", \"three\", \"four\"])\n",
    "\n",
    "display(df)\n",
    "# 하나의 특정 컬럼만 선택\n",
    "#df[\"이름\"] #df.이름    \n",
    "type(df[\"이름\"])    #Series 형태로 나타남 (DataFrame은 여러 Series로 되어있기 때문에)\n",
    "df[[\"학과\",\"학점\"]]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "one      이지안\n",
       "two      박동훈\n",
       "three    유관순\n",
       "four     강감찬\n",
       "Name: 이름, dtype: object"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>학과</th>\n",
       "      <th>이름</th>\n",
       "      <th>학점</th>\n",
       "      <th>학년</th>\n",
       "      <th>등급</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>one</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>이지안</td>\n",
       "      <td>2.5</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>two</th>\n",
       "      <td>기계</td>\n",
       "      <td>박동훈</td>\n",
       "      <td>3.6</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>three</th>\n",
       "      <td>철학</td>\n",
       "      <td>홍길동</td>\n",
       "      <td>4.3</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>four</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>강감찬</td>\n",
       "      <td>3.8</td>\n",
       "      <td>4</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        학과   이름   학점  학년   등급\n",
       "one    컴퓨터  이지안  2.5   1  NaN\n",
       "two     기계  박동훈  3.6   1  NaN\n",
       "three   철학  홍길동  4.3   2  NaN\n",
       "four   컴퓨터  강감찬  3.8   4  NaN"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>학과</th>\n",
       "      <th>이름</th>\n",
       "      <th>학점</th>\n",
       "      <th>학년</th>\n",
       "      <th>등급</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>one</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>이지안</td>\n",
       "      <td>2.5</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      학과   이름   학점  학년   등급\n",
       "one  컴퓨터  이지안  2.5   1  NaN"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# DataFrame에서 특정 column을 추출하면 'View'!!\n",
    "# View를 사용하지 않고 새로운 Series를 생성하려면 copy()를 이용\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "data = { \"이름\" : [\"이지안\",\"박동훈\",\"홍길동\",\"강감찬\"],\n",
    "          \"학과\" : [\"컴퓨터\",\"기계\",\"철학\",\"컴퓨터\"],\n",
    "          \"학년\": [1,1,2,4],\n",
    "          \"학점\" : [2.5,3.6,4.3,3.8] }\n",
    "df = pd.DataFrame(data,     #column의 순서 지정 , index 재정의\n",
    "                 columns = [\"학과\", \"이름\", \"학점\", \"학년\", \"등급\"] ,\n",
    "                 index = [\"one\", \"two\", \"three\", \"four\"])\n",
    "\n",
    "new_name = df[\"이름\"].copy()   #새로운 Series / copy()없으면 View\n",
    "new_name[\"three\"] = \"유관순\"\n",
    "display(new_name)\n",
    "display(df)\n",
    "new_df=df[\"등급\"].copy()\n",
    "new_df = df.copy()\n",
    "new_df[df[\"이름\"]==\"이지안\"]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "one      이지안\n",
       "two      박동훈\n",
       "three    유관순\n",
       "four     강감찬\n",
       "Name: 이름, dtype: object"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>학과</th>\n",
       "      <th>이름</th>\n",
       "      <th>학점</th>\n",
       "      <th>학년</th>\n",
       "      <th>등급</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>one</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>이지안</td>\n",
       "      <td>2.5</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>two</th>\n",
       "      <td>기계</td>\n",
       "      <td>박동훈</td>\n",
       "      <td>3.6</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>three</th>\n",
       "      <td>철학</td>\n",
       "      <td>홍길동</td>\n",
       "      <td>4.3</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>four</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>강감찬</td>\n",
       "      <td>3.8</td>\n",
       "      <td>4</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        학과   이름   학점  학년   등급\n",
       "one    컴퓨터  이지안  2.5   1  NaN\n",
       "two     기계  박동훈  3.6   1  NaN\n",
       "three   철학  홍길동  4.3   2  NaN\n",
       "four   컴퓨터  강감찬  3.8   4  NaN"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>학과</th>\n",
       "      <th>이름</th>\n",
       "      <th>학점</th>\n",
       "      <th>학년</th>\n",
       "      <th>등급</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>one</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>이지안</td>\n",
       "      <td>2.5</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>two</th>\n",
       "      <td>기계</td>\n",
       "      <td>박동훈</td>\n",
       "      <td>3.6</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>three</th>\n",
       "      <td>철학</td>\n",
       "      <td>유관순</td>\n",
       "      <td>4.3</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>four</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>강감찬</td>\n",
       "      <td>3.8</td>\n",
       "      <td>4</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        학과   이름   학점  학년   등급\n",
       "one    컴퓨터  이지안  2.5   1  NaN\n",
       "two     기계  박동훈  3.6   1  NaN\n",
       "three   철학  유관순  4.3   2  NaN\n",
       "four   컴퓨터  강감찬  3.8   4  NaN"
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "data = { \"이름\" : [\"이지안\",\"박동훈\",\"홍길동\",\"강감찬\"],\n",
    "          \"학과\" : [\"컴퓨터\",\"기계\",\"철학\",\"컴퓨터\"],\n",
    "          \"학년\": [1,1,2,4],\n",
    "          \"학점\" : [2.5,3.6,4.3,3.8] }\n",
    "df = pd.DataFrame(data,     #column의 순서 지정 , index 재정의\n",
    "                 columns = [\"학과\", \"이름\", \"학점\", \"학년\", \"등급\"] ,\n",
    "                 index = [\"one\", \"two\", \"three\", \"four\"])\n",
    "\n",
    "new_name = df[\"이름\"].copy()   #새로운 Series / copy()없으면 View\n",
    "new_name[\"three\"] = \"유관순\"   # \"three\"인 행의 \"이름\"을 유관순으로 바꿔라\n",
    "display(new_name)\n",
    "display(df)\n",
    "new_df=df[\"등급\"].copy()\n",
    "new_df = df.copy()\n",
    "new_df[df[\"이름\"]==\"이지안\"]\n",
    "df.loc[\"three\" , \"이름\"] = \"유관순\"\n",
    "df\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 100,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[2 3]\n",
      "[False False False  True  True  True]\n",
      "[4 5 6]\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "array([2, 5])"
      ]
     },
     "execution_count": 100,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# indexing, boolean indexing, fancy indexing, slicing\n",
    "import numpy as np\n",
    "\n",
    "arr = np.array([1,2,3,4,5,6])\n",
    "arr[-1]   # 6 => indexing\n",
    "print(arr[1:3])  # [2 3] => slicing\n",
    "print(arr > 3)   # array에 대해 논리 연산을 수행\n",
    "#                  boolean mask가 생성\n",
    "#                  boolean indexing은 index위치에 \n",
    "#                  boolean mask를 이용하는 indexing 방법\n",
    "print(arr[arr>3])        #요소가 3보다 큰 요소만 뽑아냄\n",
    "\n",
    "# Fancy indexing은 index부분에 index 배열을 사용하는 indexing 방법\n",
    "arr[[1,4]]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>학과</th>\n",
       "      <th>이름</th>\n",
       "      <th>학점</th>\n",
       "      <th>학년</th>\n",
       "      <th>등급</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>one</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>이지안</td>\n",
       "      <td>2.5</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>two</th>\n",
       "      <td>기계</td>\n",
       "      <td>박동훈</td>\n",
       "      <td>3.6</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>three</th>\n",
       "      <td>철학</td>\n",
       "      <td>홍길동</td>\n",
       "      <td>4.3</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>four</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>강감찬</td>\n",
       "      <td>3.8</td>\n",
       "      <td>4</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        학과   이름   학점  학년   등급\n",
       "one    컴퓨터  이지안  2.5   1  NaN\n",
       "two     기계  박동훈  3.6   1  NaN\n",
       "three   철학  홍길동  4.3   2  NaN\n",
       "four   컴퓨터  강감찬  3.8   4  NaN"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>학과</th>\n",
       "      <th>학년</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>one</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>four</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       학과  학년\n",
       "one   컴퓨터   1\n",
       "four  컴퓨터   4"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# DataFrame에 대해서도 Fancy indexing을 사용할 수 있다.\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "data = { \"이름\" : [\"이지안\",\"박동훈\",\"홍길동\",\"강감찬\"],\n",
    "          \"학과\" : [\"컴퓨터\",\"기계\",\"철학\",\"컴퓨터\"],\n",
    "          \"학년\": [1,1,2,4],\n",
    "          \"학점\" : [2.5,3.6,4.3,3.8] }\n",
    "df = pd.DataFrame(data,     #column의 순서 지정 , index 재정의\n",
    "                 columns = [\"학과\", \"이름\", \"학점\", \"학년\", \"등급\"] ,\n",
    "                 index = [\"one\", \"two\", \"three\", \"four\"])\n",
    "\n",
    "display(df)\n",
    "df[[\"이름\",\"학년\"]]   # Fancy indexing\n",
    "df.loc[[\"one\", \"four\"] , [\"학과\", \"학년\"]]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>학과</th>\n",
       "      <th>이름</th>\n",
       "      <th>학점</th>\n",
       "      <th>학년</th>\n",
       "      <th>등급</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>one</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>이지안</td>\n",
       "      <td>2.5</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>two</th>\n",
       "      <td>기계</td>\n",
       "      <td>박동훈</td>\n",
       "      <td>3.6</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>three</th>\n",
       "      <td>철학</td>\n",
       "      <td>홍길동</td>\n",
       "      <td>4.3</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>four</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>강감찬</td>\n",
       "      <td>3.8</td>\n",
       "      <td>4</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        학과   이름   학점  학년   등급\n",
       "one    컴퓨터  이지안  2.5   1  NaN\n",
       "two     기계  박동훈  3.6   1  NaN\n",
       "three   철학  홍길동  4.3   2  NaN\n",
       "four   컴퓨터  강감찬  3.8   4  NaN"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "        학과   이름   학점  학년   등급\n",
      "one    컴퓨터  이지안  2.5   1    A\n",
      "two     기계  박동훈  3.6   1    A\n",
      "three   철학  홍길동  4.3   2  NaN\n",
      "four   컴퓨터  강감찬  3.8   4  NaN\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>학과</th>\n",
       "      <th>이름</th>\n",
       "      <th>학점</th>\n",
       "      <th>학년</th>\n",
       "      <th>등급</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>one</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>이지안</td>\n",
       "      <td>2.5</td>\n",
       "      <td>1</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>two</th>\n",
       "      <td>기계</td>\n",
       "      <td>박동훈</td>\n",
       "      <td>3.6</td>\n",
       "      <td>1</td>\n",
       "      <td>A</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>three</th>\n",
       "      <td>철학</td>\n",
       "      <td>홍길동</td>\n",
       "      <td>4.3</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>four</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>강감찬</td>\n",
       "      <td>3.8</td>\n",
       "      <td>4</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        학과   이름   학점  학년   등급\n",
       "one    컴퓨터  이지안  2.5   1    A\n",
       "two     기계  박동훈  3.6   1    A\n",
       "three   철학  홍길동  4.3   2  NaN\n",
       "four   컴퓨터  강감찬  3.8   4  NaN"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# indexing을 이용해 DataFrame 에서 특정 column을 선택할 수 있다.\n",
    "\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "data = { \"이름\" : [\"이지안\",\"박동훈\",\"홍길동\",\"강감찬\"],\n",
    "          \"학과\" : [\"컴퓨터\",\"기계\",\"철학\",\"컴퓨터\"],\n",
    "          \"학년\": [1,1,2,4],\n",
    "          \"학점\" : [2.5,3.6,4.3,3.8] }\n",
    "df = pd.DataFrame(data,     #column의 순서 지정 , index 재정의\n",
    "                 columns = [\"학과\", \"이름\", \"학점\", \"학년\", \"등급\"] ,\n",
    "                 index = [\"one\", \"two\", \"three\", \"four\"])\n",
    "display(df)\n",
    "#df[\"등급\"] =[\"A\",\"B\",\"D\",\"C\"]    # list, numpy array, tuple 형태 모두 사용 가능\n",
    "#df[[\"이름\",\"등급\"]] = [[\"홍길동\",\"A\"], [\"김길동\",\"B\"],[\"최길동\",\"C\"],[\"박길동\",\"A]\n",
    "\n",
    "df.loc[ df[\"학년\"] ==1 , \"등급\" ] = \"A\"\n",
    "print(df)\n",
    "#df.loc[df[\"학년\"] == 1, \"등급\" = \"A\"]\n",
    "display(df)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 76,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>학과</th>\n",
       "      <th>이름</th>\n",
       "      <th>학점</th>\n",
       "      <th>학년</th>\n",
       "      <th>등급</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>one</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>이지안</td>\n",
       "      <td>2.5</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>two</th>\n",
       "      <td>기계</td>\n",
       "      <td>박동훈</td>\n",
       "      <td>3.6</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>three</th>\n",
       "      <td>철학</td>\n",
       "      <td>홍길동</td>\n",
       "      <td>4.3</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>four</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>강감찬</td>\n",
       "      <td>3.8</td>\n",
       "      <td>4</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        학과   이름   학점  학년   등급\n",
       "one    컴퓨터  이지안  2.5   1  NaN\n",
       "two     기계  박동훈  3.6   1  NaN\n",
       "three   철학  홍길동  4.3   2  NaN\n",
       "four   컴퓨터  강감찬  3.8   4  NaN"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>학과</th>\n",
       "      <th>이름</th>\n",
       "      <th>학점</th>\n",
       "      <th>학년</th>\n",
       "      <th>등급</th>\n",
       "      <th>나이</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>one</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>이지안</td>\n",
       "      <td>2.5</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>20.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>two</th>\n",
       "      <td>기계</td>\n",
       "      <td>박동훈</td>\n",
       "      <td>3.6</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>22.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>three</th>\n",
       "      <td>철학</td>\n",
       "      <td>홍길동</td>\n",
       "      <td>4.3</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>four</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>강감찬</td>\n",
       "      <td>3.8</td>\n",
       "      <td>4</td>\n",
       "      <td>NaN</td>\n",
       "      <td>20.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        학과   이름   학점  학년   등급    나이\n",
       "one    컴퓨터  이지안  2.5   1  NaN  20.0\n",
       "two     기계  박동훈  3.6   1  NaN  22.0\n",
       "three   철학  홍길동  4.3   2  NaN   NaN\n",
       "four   컴퓨터  강감찬  3.8   4  NaN  20.0"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# 기존 DataFrame에 새로운 column을 추가해보자.\n",
    "# 새로운 column을 정의하고 그 값을 명시\n",
    "# scalar, list, numpy array, pandas Series를 이용\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "data = { \"이름\" : [\"이지안\",\"박동훈\",\"홍길동\",\"강감찬\"],\n",
    "          \"학과\" : [\"컴퓨터\",\"기계\",\"철학\",\"컴퓨터\"],\n",
    "          \"학년\": [1,1,2,4],\n",
    "          \"학점\" : [2.5,3.6,4.3,3.8] }\n",
    "df = pd.DataFrame(data,     #column의 순서 지정 , index 재정의\n",
    "                 columns = [\"학과\", \"이름\", \"학점\", \"학년\", \"등급\"] ,\n",
    "                 index = [\"one\", \"two\", \"three\", \"four\"])\n",
    "display(df)\n",
    "df[\"나이\"] =np.array([20,22,23,24])    #에러가 아니라 새로운 column 추가\n",
    "# list, numpy array, tuple 형태 모두 사용 가능\n",
    "df[\"나이\"]=pd.Series([20,22,21,20],\n",
    "                  index=[\"one\",\"two\",\"three\",\"four\"])  \n",
    "# pandas Series는 index를 기준으로 맵핑해서 들어가기 때문에 \n",
    "# index가 다르면 들어가지 않음(index 따로 적지 않으면 0부터~)\n",
    "df[\"나이\"]=pd.Series([20,22,20],\n",
    "                  index=[\"one\",\"two\",\"four\"])\n",
    "# index를 기반으로 들어가기 때문에 개수를 맞추지 않아도 됨\n",
    "display(df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 83,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>학과</th>\n",
       "      <th>이름</th>\n",
       "      <th>학점</th>\n",
       "      <th>학년</th>\n",
       "      <th>등급</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>one</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>이지안</td>\n",
       "      <td>2.5</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>two</th>\n",
       "      <td>기계</td>\n",
       "      <td>박동훈</td>\n",
       "      <td>3.6</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>three</th>\n",
       "      <td>철학</td>\n",
       "      <td>홍길동</td>\n",
       "      <td>4.3</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>four</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>강감찬</td>\n",
       "      <td>3.8</td>\n",
       "      <td>4</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        학과   이름   학점  학년   등급\n",
       "one    컴퓨터  이지안  2.5   1  NaN\n",
       "two     기계  박동훈  3.6   1  NaN\n",
       "three   철학  홍길동  4.3   2  NaN\n",
       "four   컴퓨터  강감찬  3.8   4  NaN"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>학과</th>\n",
       "      <th>이름</th>\n",
       "      <th>학점</th>\n",
       "      <th>학년</th>\n",
       "      <th>등급</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>one</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>이지안</td>\n",
       "      <td>3.5</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>two</th>\n",
       "      <td>기계</td>\n",
       "      <td>박동훈</td>\n",
       "      <td>4.6</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>three</th>\n",
       "      <td>철학</td>\n",
       "      <td>홍길동</td>\n",
       "      <td>5.3</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>four</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>강감찬</td>\n",
       "      <td>4.8</td>\n",
       "      <td>4</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        학과   이름   학점  학년   등급\n",
       "one    컴퓨터  이지안  3.5   1  NaN\n",
       "two     기계  박동훈  4.6   1  NaN\n",
       "three   철학  홍길동  5.3   2  NaN\n",
       "four   컴퓨터  강감찬  4.8   4  NaN"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>학과</th>\n",
       "      <th>이름</th>\n",
       "      <th>학점</th>\n",
       "      <th>학년</th>\n",
       "      <th>등급</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>two</th>\n",
       "      <td>기계</td>\n",
       "      <td>박동훈</td>\n",
       "      <td>4.6</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>three</th>\n",
       "      <td>철학</td>\n",
       "      <td>홍길동</td>\n",
       "      <td>5.3</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>four</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>강감찬</td>\n",
       "      <td>4.8</td>\n",
       "      <td>4</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        학과   이름   학점  학년   등급\n",
       "two     기계  박동훈  4.6   1  NaN\n",
       "three   철학  홍길동  5.3   2  NaN\n",
       "four   컴퓨터  강감찬  4.8   4  NaN"
      ]
     },
     "execution_count": 83,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# 기본 DataFrame에 대로운 column을 추가해보자!\n",
    "# 기존 column에 연산을 해서 새로운 column을 생성\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "data = { \"이름\" : [\"이지안\",\"박동훈\",\"홍길동\",\"강감찬\"],\n",
    "          \"학과\" : [\"컴퓨터\",\"기계\",\"철학\",\"컴퓨터\"],\n",
    "          \"학년\": [1,1,2,4],\n",
    "          \"학점\" : [2.5,3.6,4.3,3.8] }\n",
    "df = pd.DataFrame(data,     #column의 순서 지정 , index 재정의\n",
    "                 columns = [\"학과\", \"이름\", \"학점\", \"학년\", \"등급\"] ,\n",
    "                 index = [\"one\", \"two\", \"three\", \"four\"])\n",
    "display(df)\n",
    "df[\"학점\"] = df[\"학점\"] + 1 \n",
    "display(df)\n",
    "df[\"장학여부\"] = df[\"학점\"] > 4.0\n",
    "display(df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 86,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>학과</th>\n",
       "      <th>이름</th>\n",
       "      <th>학점</th>\n",
       "      <th>학년</th>\n",
       "      <th>등급</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>one</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>이지안</td>\n",
       "      <td>2.5</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>two</th>\n",
       "      <td>기계</td>\n",
       "      <td>박동훈</td>\n",
       "      <td>3.6</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>three</th>\n",
       "      <td>철학</td>\n",
       "      <td>홍길동</td>\n",
       "      <td>4.3</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>four</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>강감찬</td>\n",
       "      <td>3.8</td>\n",
       "      <td>4</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        학과   이름   학점  학년   등급\n",
       "one    컴퓨터  이지안  2.5   1  NaN\n",
       "two     기계  박동훈  3.6   1  NaN\n",
       "three   철학  홍길동  4.3   2  NaN\n",
       "four   컴퓨터  강감찬  3.8   4  NaN"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>학과</th>\n",
       "      <th>이름</th>\n",
       "      <th>학점</th>\n",
       "      <th>학년</th>\n",
       "      <th>등급</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>one</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>이지안</td>\n",
       "      <td>2.5</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>two</th>\n",
       "      <td>기계</td>\n",
       "      <td>박동훈</td>\n",
       "      <td>3.6</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>three</th>\n",
       "      <td>철학</td>\n",
       "      <td>홍길동</td>\n",
       "      <td>4.3</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>four</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>강감찬</td>\n",
       "      <td>3.8</td>\n",
       "      <td>4</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        학과   이름   학점  학년   등급\n",
       "one    컴퓨터  이지안  2.5   1  NaN\n",
       "two     기계  박동훈  3.6   1  NaN\n",
       "three   철학  홍길동  4.3   2  NaN\n",
       "four   컴퓨터  강감찬  3.8   4  NaN"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>학과</th>\n",
       "      <th>이름</th>\n",
       "      <th>학점</th>\n",
       "      <th>학년</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>one</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>이지안</td>\n",
       "      <td>2.5</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>two</th>\n",
       "      <td>기계</td>\n",
       "      <td>박동훈</td>\n",
       "      <td>3.6</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>three</th>\n",
       "      <td>철학</td>\n",
       "      <td>홍길동</td>\n",
       "      <td>4.3</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>four</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>강감찬</td>\n",
       "      <td>3.8</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        학과   이름   학점  학년\n",
       "one    컴퓨터  이지안  2.5   1\n",
       "two     기계  박동훈  3.6   1\n",
       "three   철학  홍길동  4.3   2\n",
       "four   컴퓨터  강감찬  3.8   4"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# 특정 column을 삭제할 수 있다.\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "data = { \"이름\" : [\"이지안\",\"박동훈\",\"홍길동\",\"강감찬\"],\n",
    "          \"학과\" : [\"컴퓨터\",\"기계\",\"철학\",\"컴퓨터\"],\n",
    "          \"학년\": [1,1,2,4],\n",
    "          \"학점\" : [2.5,3.6,4.3,3.8] }\n",
    "df = pd.DataFrame(data,     #column의 순서 지정 , index 재정의\n",
    "                 columns = [\"학과\", \"이름\", \"학점\", \"학년\", \"등급\"] ,\n",
    "                 index = [\"one\", \"two\", \"three\", \"four\"])\n",
    "display(df)\n",
    "# del df[\"등급\"]   # 거의 사용되지 않는다.\n",
    "# display(df)\n",
    "#df.drop(\"등급\", axis=1, inplace=True)   # axis =1 열방향에서 '등급'을 찾아 지워라.\n",
    "new_df = df.drop(\"등급\", axis=1, inplace=False)\n",
    "# inplace =True : 원본을 지우고, 리턴 None\n",
    "# inplace = False : df원본을 건들지 말고 삭제 처리한 결과df 리턴\n",
    "display(df)\n",
    "display(new_df)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 91,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>학과</th>\n",
       "      <th>이름</th>\n",
       "      <th>학점</th>\n",
       "      <th>학년</th>\n",
       "      <th>등급</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>one</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>이지안</td>\n",
       "      <td>2.5</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>two</th>\n",
       "      <td>기계</td>\n",
       "      <td>박동훈</td>\n",
       "      <td>3.6</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>three</th>\n",
       "      <td>철학</td>\n",
       "      <td>홍길동</td>\n",
       "      <td>4.3</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>four</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>강감찬</td>\n",
       "      <td>3.8</td>\n",
       "      <td>4</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        학과   이름   학점  학년   등급\n",
       "one    컴퓨터  이지안  2.5   1  NaN\n",
       "two     기계  박동훈  3.6   1  NaN\n",
       "three   철학  홍길동  4.3   2  NaN\n",
       "four   컴퓨터  강감찬  3.8   4  NaN"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>학과</th>\n",
       "      <th>이름</th>\n",
       "      <th>학점</th>\n",
       "      <th>학년</th>\n",
       "      <th>등급</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>one</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>이지안</td>\n",
       "      <td>2.5</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>two</th>\n",
       "      <td>기계</td>\n",
       "      <td>박동훈</td>\n",
       "      <td>3.6</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>three</th>\n",
       "      <td>철학</td>\n",
       "      <td>홍길동</td>\n",
       "      <td>4.3</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        학과   이름   학점  학년   등급\n",
       "one    컴퓨터  이지안  2.5   1  NaN\n",
       "two     기계  박동훈  3.6   1  NaN\n",
       "three   철학  홍길동  4.3   2  NaN"
      ]
     },
     "execution_count": 91,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# DataFrame의 row\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "data = { \"이름\" : [\"이지안\",\"박동훈\",\"홍길동\",\"강감찬\"],\n",
    "          \"학과\" : [\"컴퓨터\",\"기계\",\"철학\",\"컴퓨터\"],\n",
    "          \"학년\": [1,1,2,4],\n",
    "          \"학점\" : [2.5,3.6,4.3,3.8] }\n",
    "df = pd.DataFrame(data,     #column의 순서 지정 , index 재정의\n",
    "                 columns = [\"학과\", \"이름\", \"학점\", \"학년\", \"등급\"] ,\n",
    "                 index = [\"one\", \"two\", \"three\", \"four\"])\n",
    "display(df)\n",
    "#df[0]     # 행을 선택하기 위해서 숫자 index를 바로 이용할 수 없다.\n",
    "df[0:1]    # slicing은 가능, slicing은 원본에서 부분을 뽑아오는 것이기 때문에\n",
    "#            결과는 DataFrame\n",
    "#df[\"one\"]       # 행을 선택하기 위해서 index 값을 바로 이용할 수 없다.\n",
    "df[\"one\":\"three\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'이름': ['이지안', '박동훈', '홍길동', '강감찬'],\n",
       " '학과': ['컴퓨터', '기계', '철학', '컴퓨터'],\n",
       " '학년': [1, 1, 2, 4],\n",
       " '학점': [2.5, 3.6, 4.3, 3.8]}"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>학과</th>\n",
       "      <th>이름</th>\n",
       "      <th>학점</th>\n",
       "      <th>학년</th>\n",
       "      <th>등급</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>one</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>이지안</td>\n",
       "      <td>2.5</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>two</th>\n",
       "      <td>기계</td>\n",
       "      <td>박동훈</td>\n",
       "      <td>3.6</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>three</th>\n",
       "      <td>철학</td>\n",
       "      <td>홍길동</td>\n",
       "      <td>4.3</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>four</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>강감찬</td>\n",
       "      <td>3.8</td>\n",
       "      <td>4</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        학과   이름   학점  학년   등급\n",
       "one    컴퓨터  이지안  2.5   1  NaN\n",
       "two     기계  박동훈  3.6   1  NaN\n",
       "three   철학  홍길동  4.3   2  NaN\n",
       "four   컴퓨터  강감찬  3.8   4  NaN"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "        학과   이름   학점  학년   등급\n",
      "one    컴퓨터  이지안  2.5   1  NaN\n",
      "three   철학  홍길동  4.3   2  NaN\n",
      "        학과   이름   학점  학년   등급\n",
      "two     기계  박동훈  3.6   1  NaN\n",
      "three   철학  홍길동  4.3   2  NaN\n",
      "four   컴퓨터  강감찬  3.8   4  NaN\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>이름</th>\n",
       "      <th>학점</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>two</th>\n",
       "      <td>박동훈</td>\n",
       "      <td>3.6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>three</th>\n",
       "      <td>홍길동</td>\n",
       "      <td>4.3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>four</th>\n",
       "      <td>강감찬</td>\n",
       "      <td>3.8</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        이름   학점\n",
       "two    박동훈  3.6\n",
       "three  홍길동  4.3\n",
       "four   강감찬  3.8"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# DataFrame의 행 제어(loc)\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "data = { \"이름\" : [\"이지안\",\"박동훈\",\"홍길동\",\"강감찬\"],\n",
    "          \"학과\" : [\"컴퓨터\",\"기계\",\"철학\",\"컴퓨터\"],\n",
    "          \"학년\": [1,1,2,4],\n",
    "          \"학점\" : [2.5,3.6,4.3,3.8] }\n",
    "display(data)\n",
    "df = pd.DataFrame(data,     #column의 순서 지정 , index 재정의\n",
    "                 columns = [\"학과\", \"이름\", \"학점\", \"학년\", \"등급\"] ,\n",
    "                 index = [\"one\", \"two\", \"three\", \"four\"])\n",
    "display(df)\n",
    "df.loc[\"one\"]              # indexing => 결과를 Series로 뽑아냄\n",
    "print(df.loc[[\"one\",\"three\"]])    # fancy indexing\n",
    "df[\"학점\"]> 3.0\n",
    "print(df.loc[df[\"학점\"]> 3.0])     # boolean indexing\n",
    "df.loc[df[\"학점\"]> 3.0, \"이름\"]     \n",
    "df.loc[df[\"학점\"]> 3.0, [\"이름\",\"학점\"]]   #loc를 사용하면 행과 열 둘 다 선택 가능함     "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>학과</th>\n",
       "      <th>이름</th>\n",
       "      <th>학점</th>\n",
       "      <th>학년</th>\n",
       "      <th>등급</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>one</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>이지안</td>\n",
       "      <td>2.5</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>two</th>\n",
       "      <td>기계</td>\n",
       "      <td>박동훈</td>\n",
       "      <td>3.6</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>three</th>\n",
       "      <td>철학</td>\n",
       "      <td>홍길동</td>\n",
       "      <td>4.3</td>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>four</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>강감찬</td>\n",
       "      <td>3.8</td>\n",
       "      <td>4</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        학과   이름   학점  학년   등급\n",
       "one    컴퓨터  이지안  2.5   1  NaN\n",
       "two     기계  박동훈  3.6   1  NaN\n",
       "three   철학  홍길동  4.3   2  NaN\n",
       "four   컴퓨터  강감찬  3.8   4  NaN"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>학과</th>\n",
       "      <th>이름</th>\n",
       "      <th>학점</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>one</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>이지안</td>\n",
       "      <td>2.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>two</th>\n",
       "      <td>기계</td>\n",
       "      <td>박동훈</td>\n",
       "      <td>3.6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>three</th>\n",
       "      <td>철학</td>\n",
       "      <td>홍길동</td>\n",
       "      <td>4.3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>four</th>\n",
       "      <td>컴퓨터</td>\n",
       "      <td>강감찬</td>\n",
       "      <td>3.8</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        학과   이름   학점\n",
       "one    컴퓨터  이지안  2.5\n",
       "two     기계  박동훈  3.6\n",
       "three   철학  홍길동  4.3\n",
       "four   컴퓨터  강감찬  3.8"
      ]
     },
     "execution_count": 47,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "data = { \"이름\" : [\"이지안\",\"박동훈\",\"홍길동\",\"강감찬\"],\n",
    "          \"학과\" : [\"컴퓨터\",\"기계\",\"철학\",\"컴퓨터\"],\n",
    "          \"학년\": [1,1,2,4],\n",
    "          \"학점\" : [2.5,3.6,4.3,3.8] }\n",
    "df = pd.DataFrame(data,     #column의 순서 지정 , index 재정의\n",
    "                 columns = [\"학과\", \"이름\", \"학점\", \"학년\", \"등급\"] ,\n",
    "                 index = [\"one\", \"two\", \"three\", \"four\"])\n",
    "display(df)\n",
    "\n",
    "df[[\"학과\",\"학년\"]]\n",
    "df.loc[:,\"학과\":\"학점\"]    # 컬럼을 slicing할 때 loc를 쓰면서 모든 행에 대해 \n",
    "#                           학과 ~ 학점 slicing\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "       학과   이름   학점  학년 등급\n",
      "two    기계  박동훈  3.3   1  A\n",
      "three  철학  홍길동  3.9   2  A\n"
     ]
    }
   ],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "data = { \"이름\" : [\"이지안\",\"박동훈\",\"홍길동\",\"강감찬\"],\n",
    "          \"학과\" : [\"컴퓨터\",\"기계\",\"철학\",\"컴퓨터\"],\n",
    "          \"학년\": [1,1,2,4],\n",
    "          \"학점\" : [2.5,3.3,3.9,1.8] }\n",
    "df = pd.DataFrame(data,    \n",
    "                 columns = [\"학과\", \"이름\", \"학점\", \"학년\", \"등급\"] ,\n",
    "                 index = [\"one\", \"two\", \"three\", \"four\"])\n",
    "my_df =df.loc[df[\"학점\"] > 3.0].copy()\n",
    "my_df[\"등급\"] =\"A\"\n",
    "print(my_df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Pandas\n",
    "# 1. Series\n",
    "# 2. DataFrame (일반적으로 사용하는 자료 구조)\n",
    "\n",
    "# DataFrame 생성 ( Dictionary 이용 )\n",
    "import numpy as np\n",
    "import  pandas as pd\n",
    "\n",
    "data = { \"이름\" : [\"이지안\",\"박동훈\",\"홍길동\"],\n",
    "          \"학과\" : [\"컴퓨터\",\"기계 \",\"철학 \"],\n",
    "          \"학년\": np.array([1,1,2])\n",
    "         }\n",
    "\n",
    "\n",
    "df = pd.DataFrame(data,\n",
    "                  columns=[\"학년\",\"학과\",\"이름\",\"학점\"]\n",
    "                  , index= [\"011\",\"012\",\"013\",])\n",
    "\n",
    "# @@@@@@@@@ DataFrame 실제로 생성하는 방법 @@@@@@@@@@@\n",
    "# 1. 파일처리 (CSV)\n",
    "# 2. Database에서 data를 selection해서 DataFrame을 생성\n",
    "# 3. Open API 처럼 외부 프로그램을 통해 DataFrame을 생성 (JSON)\n",
    "# DataFrame의 column과 row에 대한 CRUD 처리\n",
    "\n",
    "df[\"학점\"]=[2.4,3.5,4.0]\n",
    "df[\"이름\"]    # 특정 column을 read, 결과는 Series로 return\n",
    "df[[\"학년\",\"이름\"]] # fancy indexing, DataFrame으로 return\n",
    "df[\"학과\"] = \"국문학과\"  # indexing의 결과는 view\n",
    "#                        column의 값을 수정 (update)\n",
    "\n",
    "df[\"장학여부\"] = True   # column에 대한 creating\n",
    "new_df=df.drop(\"학점\", axis = 1 , inplace = False ) \n",
    "\n",
    "# @@@@@ DataFrame의 row에 대한 CRUD 처리\n",
    "# df[0]     # 행을 read할 때 indexing은 사용할 수 없다.\n",
    "# df[0:2]     행을 선택할 때 slicing은 사용할 수 있다.\n",
    "\n",
    "#df.loc[0]   # loc는 indexing을 사용할 수 있도록 제공\n",
    "#             DataFrame이 가지고 있는 숫자 index는 사용 X\n",
    "print(df.loc[\"011\"])  # index 값으로 행 선택이 가능하고 결과 Series로 리턴 \n",
    "print(df.iloc[1:3])            # iloc 숫자 index 사용 가능,\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "data = { \"이름\" : [\"이지안\",\"박동훈\",\"홍길동\",\"강감찬\"],\n",
    "          \"학과\" : [\"컴퓨터\",\"기계\",\"철학\",\"컴퓨터\"],\n",
    "          \"학년\": [1,1,2,4],\n",
    "          \"학점\" : [2.5,3.6,4.3,3.8] }\n",
    "df = pd.DataFrame(data,     #column의 순서 지정 , index 재정의\n",
    "                 columns = [\"학과\", \"이름\", \"학점\", \"학년\", \"등급\"] ,\n",
    "                 index = [\"one\", \"two\", \"three\", \"four\"])\n",
    "\n",
    "df.loc[\"five\", [\"학과\", \"이름\", \"학년\",\"등급\"]]= [\"컴퓨터\",\"김길동\",\"3\", np.nan]\n",
    "\n",
    "print(df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# 간단한 문제 풀기\n",
    "\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "data = { \"이름\" : [\"이지안\",\"박동훈\",\"홍길동\",\"강감찬\"],\n",
    "          \"학과\" : [\"컴퓨터\",\"기계\",\"철학\",\"컴퓨터\"],\n",
    "          \"학년\": [1,1,2,4],\n",
    "          \"학점\" : [2.4,3.3,3.9,1.8] }\n",
    "df = pd.DataFrame(data,    \n",
    "                 columns = [\"학과\", \"이름\", \"학점\", \"학년\", \"등급\"] ,\n",
    "                 index = [\"one\", \"two\", \"three\", \"four\"])\n",
    "\n",
    "# 1. 이름이 '박동훈'인 사람을 찾아서 이름과 학점을 출력\n",
    "print(df.loc[df[\"이름\"] == \"박동훈\" , [\"이름\", \"학점\"]])\n",
    "\n",
    "\n",
    "# 2. 학점이 (1.5,2.5)인 사람을 찾아서 학과, 이름, 학점 출력\n",
    "new_df = df.loc[ df[\"학점\"] < 2.5 , \"학과\":\"학점\"]\n",
    "print(new_df)\n",
    "\n",
    "# 3. 학점이 3.0이상인 사람을 찾아서 등급을 A로 변경한 후 출력\n",
    "df.loc[df[\"학점\"]> 3.0 , \"등급\" ] = \"A\"\n",
    "print(df)\n",
    "\n",
    "\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# NaN 값의 처리\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "np.random.seed(4)\n",
    "arr = np.random.randint(0,10,(4,3))\n",
    "\n",
    "df = pd.DataFrame(arr)\n",
    "df.columns = [\"A\",\"B\", \"C\"]\n",
    "df.index = pd.date_range(\"20190101\", periods=4 )\n",
    "df[\"D\"] = [7, np.nan , 4, np.nan]   # np.nan은 실수로 간주\n",
    "# 결측 값을 제거\n",
    "# NaN이 포함된 행을 모두 삭제\n",
    "df.dropna(how=\"any\" , inplace=True)    \n",
    "# how=\"any\" : 행에 nan이 하나라도 포함되어 있으면 삭제\n",
    "#df.dropna(how=\"all\" , inplace=True)    \n",
    "# how=\"all\" : 모든 컬럼 값이 nan이면 해당 행 삭제\n",
    "# 또 다른 경우는 NaN이 너무 많아서 삭제가 힘들 경우\n",
    "# new_df = df.fillna(value=0 ,inplace=False)\n",
    "# DataFrame에 대해 NaN에 대한 boolean mask를 생성\n",
    "print(df.isnull()[\"D\"])\n",
    "print(df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# DataFrame의 생성과 사용에 기본적인 내용을 알아봤다.\n",
    "# 집계함수를 알아보자!\n",
    "# 평균(mean) : 여러개의 값이 있을 때 그 값들에 대한 합을 개수로 나눈 값\n",
    "#             수학적 확률의 기대치\n",
    "# 편차(deviation) : 확률변수 X와 평균값에 대한 차이.\n",
    "# 분산(variance) : 편차의 제곱의 평균\n",
    "# 표준편차(standard deviation) : 분산의 제곱근\n",
    "# 공분산\n",
    "import numpy as np\n",
    "\n",
    "arr = np.array([1,2,3,4,5] , dtype= np.int32)\n",
    "print(arr.sum())\n",
    "print(arr.mean())\n",
    "print(arr.())\n",
    "print(arr.())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# 공분산\n",
    "# 확률변수 X와 Y의 관계를 알기 위해서 사용하는 값\n",
    "# X가 변할 때 Y가 변하는 방향을 알기 위해서 사용\n",
    "# X,Y가 서로 독립이면 공분산 0\n",
    "# 공분산이 양수일경우 X가 증가하면 Y도 증가\n",
    "# 공분산이 음수일경우 X가 증가하면 Y는 감소\n",
    "# 두 확률변수의 관계정도 (strength)를 측정하기가 좋지 않다. => 상관계수 사용!\n",
    "# 공분산이 양수인경우 ( KOSPI 지수와 삼성전자 주가 )\n",
    "\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "import datetime\n",
    "import pandas_datareader.data as pdr\n",
    "\n",
    "start = datetime.datetime(2018,1,1)\n",
    "end = datetime.datetime(2018,12,31)\n",
    "\n",
    "# df_KOSPI = pdr.DataReader(\"^KS11\", \"yahoo\",start,end)\n",
    "# df_KOSPI.head()\n",
    "\n",
    "df_KOSPI = pd.read_json(\"C:\\project\\moon_py\\data\\stock/KOSPI.json\")[\"Close\"]\n",
    "#print(df_KOSPI.head())\n",
    "\n",
    "# 삼성전자에 대한 주식가격\n",
    "df_SE= pd.read_json(\"C:\\project\\moon_py\\data\\stock/SE.json\")[\"Close\"]\n",
    "# df_SE.head()\n",
    "# KOSPI와 삼성전자의 공분산을 계산\n",
    "np.cov(df_KOSPI, df_SE)\n",
    "\n",
    "df_BUSAN = pd.read_json(\"C:\\project\\moon_py\\data\\stock/부산산업.json\")[\"Close\"]\n",
    "df_LIG = pd.read_json(\"C:\\project\\moon_py\\data\\stock/LIG넥스원.json\")[\"Close\"]\n",
    "np.cov(df_BUSAN, df_LIG)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#  관계상관관계 (correlation)\n",
    "# # 서로 연관이 있어보이는\n",
    "# 성적과 자존감, 온라인 게임과 폭력성\n",
    "# 상관계수 (correlation coefficient)\n",
    "# -1 ~ 1 사이의 실수로 표현\n",
    "# 0에 가까울수록 서로 연관성이 없는 관계\n",
    "# 절대값이 1에 가까울수록 연관성이 높다.\n",
    "# 상관계수는 두 개의 확률변수에 대한 연관성에 관한 지표이지\n",
    "# 인과관계를 설명하지 않는다.\n",
    "\n",
    "start = datetime.datetime(2018,1,1)\n",
    "end = datetime.datetime(2018,12,31)\n",
    "\n",
    "df_KOSPI = pd.read_json( \"C:\\project\\moon_py\\data\\stock/KOSPI.json\")[\"Close\"]\n",
    "#print(df_KOSPI.head())\n",
    "\n",
    "# 삼성전자에 대한 주식가격\n",
    "df_SE= pd.read_json( \"C:\\project\\moon_py\\data\\stock/SE.json\")[\"Close\"]\n",
    "df_BUSAN = pd.read_json( \"C:\\project\\moon_py\\data\\stock/부산산업.json\")[\"Close\"]\n",
    "df_LIG = pd.read_json( \"C:\\project\\moon_py\\data\\stock/LIG넥스원.json\" )[\"Close\"]\n",
    "print(np.corrcoef(df_KOSPI, df_SE))\n",
    "print(np.corrcoef(df_KOSPI, df_BUSAN))\n",
    "print(np.corrcoef(df_LIG, df_BUSAN))\n",
    "\n",
    "# 0 ~0.3 약한관계, 0.3 ~ 0.7 중간관계, 0.7 ~ 1 강한관계\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# numpy를 이용해서 통계적인 내용\n",
    "# ( 평균, 분산, 표준편차, 공분산, 상관계수 )\n",
    "# pandas(DataFrame)를 이용한 통계적인 함수 사용\n",
    "\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "data = [ [2, np.nan], [7, -3], [np.nan, np.nan], [1, -2] ] \n",
    "df = pd.DataFrame(data,\n",
    "                  columns=[\"one\", \"two\"],\n",
    "                  index=[\"a\", \"b\", \"c\", \"d\"])\n",
    "\n",
    "print(df)\n",
    "print(df.sum())   # axis가 생략 axis=0 default (모든 요소를 다 더하라는 의미 아님)\n",
    "df.mean()  # NaN은 없는 것으로 간주하여 계산한다. (개수에 포함 X)\n",
    "df.sum(axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# 결측값이 있으면 계산이 불확실해진다.\n",
    "# 결측값을 해결해야 한다.(삭제, 다른 값으로 대체 )\n",
    "# one column의 결측값은 one column의 평균으로 대체\n",
    "# two column의 결측값은 two column의 최소값으로 대체\n",
    "# 결측 값을 대체하고 DataFrame을 출력\n",
    "\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "data = [ [2, np.nan], [7, -3], [np.nan, np.nan], [1, -2] ] \n",
    "df = pd.DataFrame(data,\n",
    "                  columns=[\"one\", \"two\"],\n",
    "                  index=[\"a\", \"b\", \"c\", \"d\"])\n",
    "\n",
    "# one_value = df[\"one\"].mean()\n",
    "# two_value = df[\"two\"].min()\n",
    "df[\"one\"] = df[\"one\"].fillna(value=df[\"one\"].mean(), inplace=False)\n",
    "df[\"two\"] = df[\"two\"].fillna(value=df[\"two\"].min(), inplace=False)\n",
    "print(df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# DataFrame에서 공분산과 상관계수 구하기\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "df_KOSPI = pd.read_json( \"C:\\project\\moon_py\\data\\stock/KOSPI.json\")[\"Close\"]\n",
    "df_SE= pd.read_json( \"C:\\project\\moon_py\\data\\stock/SE.json\")[\"Close\"]\n",
    "df_BUSAN = pd.read_json( \"C:\\project\\moon_py\\data\\stock/부산산업.json\")[\"Close\"]\n",
    "df_LIG = pd.read_json(\"C:\\project\\moon_py\\data\\stock/LIG넥스원.json\")[\"Close\"]\n",
    "\n",
    "data = {\"KOSPI\" : df_KOSPI,\n",
    "        \"SE\" : df_SE,\n",
    "        \"LIG\" : df_LIG,\n",
    "        \"BUSAN\" : df_BUSAN }    \n",
    "\n",
    "df= pd.DataFrame(data)\n",
    "print(df[\"BUSAN\"].cov(df[\"KOSPI\"]))  # 공분산\n",
    "print(df[\"BUSAN\"].corr(df[\"KOSPI\"]))  # 상관계수\n",
    "print(df.cov())\n",
    "\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>A</th>\n",
       "      <th>B</th>\n",
       "      <th>C</th>\n",
       "      <th>D</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2019-01-01</th>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-01-02</th>\n",
       "      <td>7</td>\n",
       "      <td>9</td>\n",
       "      <td>3</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-01-03</th>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "      <td>7</td>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-01-04</th>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>1</td>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-01-05</th>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>8</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-01-06</th>\n",
       "      <td>5</td>\n",
       "      <td>9</td>\n",
       "      <td>8</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            A  B  C  D\n",
       "2019-01-01  5  0  3  3\n",
       "2019-01-02  7  9  3  5\n",
       "2019-01-03  2  4  7  6\n",
       "2019-01-04  8  8  1  6\n",
       "2019-01-05  7  7  8  1\n",
       "2019-01-06  5  9  8  9"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>A</th>\n",
       "      <th>B</th>\n",
       "      <th>C</th>\n",
       "      <th>D</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2019-01-03</th>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-01-06</th>\n",
       "      <td>7</td>\n",
       "      <td>9</td>\n",
       "      <td>3</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-01-02</th>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "      <td>7</td>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-01-01</th>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>1</td>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-01-04</th>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>8</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019-01-05</th>\n",
       "      <td>5</td>\n",
       "      <td>9</td>\n",
       "      <td>8</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "            A  B  C  D\n",
       "2019-01-03  5  0  3  3\n",
       "2019-01-06  7  9  3  5\n",
       "2019-01-02  2  4  7  6\n",
       "2019-01-01  8  8  1  6\n",
       "2019-01-04  7  7  8  1\n",
       "2019-01-05  5  9  8  9"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# DataFrame이 제공하는 유용한 함수\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "np.random.seed(0)\n",
    "df = pd.DataFrame(np.random.randint(0, 10, (6, 4)),\n",
    "                  columns=[\"A\", \"B\", \"C\", \"D\"],\n",
    "                  index=pd.date_range(\"20190101\", periods=6))\n",
    "display(df)\n",
    "random_index = np.random.permutation(df.index)\n",
    "# df2 = df.reindex(index = random_index,\n",
    "#                  columns = [\"B\", \"C\", \"A\", \"D\"])\n",
    "df2 = df.reindex(index = random_index)\n",
    "display(df2)\n",
    "# print(random_index)\n",
    "# print(df2)\n",
    "# sort_index() 인덱스를 이용해서 정렬할 수 있다.\n",
    "# new_df2 = df2.sort_index(axis=0, ascending=False)\n",
    "# new_df3 = df.sort_index(axis=1, ascending=False)\n",
    "# print(new_df3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# DataFrame 정렬\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "np.random.seed(0)\n",
    "df = pd.DataFrame(np.random.randint(0,10,(6,4)),\n",
    "                                    columns=[\"A\", \"B\", \"C\", \"D\"],\n",
    "                                    index=pd.date_range(\"20190101\", periods=6))\n",
    "random_index = np.random.permutation(pd.date_range(\"20190101\", periods=6))\n",
    "# permutation 난수를 섞어주는 함수 : 인덱스를 랜덤하게 섞기 위해서\n",
    "df.index = random_index\n",
    "df.columns = [\"B\", \"A\", \"C\", \"D\"]\n",
    "\n",
    "# 정렬하는 방법 (index를 통해서 정렬, 값을 통해서 정렬)\n",
    "print(df)\n",
    "#print(df.sort_index(axis=0, ascending=False)) # 행 단위로 행index가 내림차순 정렬\n",
    "#print(df.sort_index(axis=1, ascending=False)) # 열 단위로 column이 내림차순 정렬\n",
    "#print(df.sort_values(by=\"B\"))   # \"B\"라는 column 값을 기준으로 오름차순\n",
    "#print(df.sort_values(by=[\"B\",\"A\"]))  # \"B\"에 같은 값이 있을 경우 \"A\"를 기준으로 정렬!\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# 유용한 함수들\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "np.random.seed(0)\n",
    "df = pd.DataFrame(np.random.randint(0,10,(6,4)),\n",
    "                                    columns=[\"A\", \"B\", \"C\", \"D\"],\n",
    "                                    index=pd.date_range(\"20190101\", periods=6))\n",
    "df[\"E\"] = [\"AA\", \"BB\", \"CC\", \"AA\", \"CC\", \"CC\"]  # 새로운 \"E\" 컬럼 추가\n",
    "\n",
    "# unique()\n",
    "print(df[\"E\"].unique())\n",
    "\n",
    "# value_counts()   # 각 value가 몇 개 있는지 알려줌! =>Series로 나옴!\n",
    "print(df[\"E\"].value_counts())   \n",
    "\n",
    "# isin()   # \"AA\", \"BB\"가 안에 있니? => 결과는 mask로 나옴!\n",
    "print(df[\"E\"].isin([\"AA\", \"BB\"]))\n",
    "\n",
    "df.drop(\"E\", axis=1, inplace=True)   # 먼저 \"E\" 컬럼을 지우고\n",
    "# lambda 함수를 사용해보자.\n",
    "func = lambda x : x.max() - x.min()   # 최대에서 최소를 빼는 함수\n",
    "print(df)\n",
    "df[\"max-min\"] = df.apply(func, axis=1)  \n",
    "# func 함수를 적용! (열 방향을 기준으로 계산해서)\n",
    "print(df)\n",
    "\n",
    "\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# inner join   두 DafaFrame을 결합할 때, 공통인 것만 합치기\n",
    "# full outer join   모두 합치기, 값이 없으면 NaN으로 나옴   \n",
    "# left outer join   full outer join 후, 왼쪽 것을 기준으로 "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "    이름       학번   학과\n",
      "0  이지안  2019001  컴퓨터\n",
      "1  홍길동  2019003   철학\n",
      "    이름       학번   학과\n",
      "0  이지안  2019001  컴퓨터\n",
      "1  박동훈  2019002  NaN\n",
      "2  홍길동  2019003   철학\n",
      "3  NaN  2019004   수학\n",
      "    이름       학번   학과\n",
      "0  이지안  2019001  컴퓨터\n",
      "1  박동훈  2019002  NaN\n",
      "2  홍길동  2019003   철학\n",
      "    이름       학번   학과\n",
      "0  이지안  2019001  컴퓨터\n",
      "1  홍길동  2019003   철학\n",
      "2  NaN  2019004   수학\n"
     ]
    }
   ],
   "source": [
    "# merge() 함수를 이용해서 join 작업을 수행 ( DataFrame의 결합 )\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "\n",
    "df1 = pd.DataFrame({\"학번\" : [\"2019001\", \"2019002\", \"2019003\"],\n",
    "                   \"이름\" : [\"이지안\", \"박동훈\", \"홍길동\"]})\n",
    "\n",
    "df2 = pd.DataFrame({\"학번\" : [\"2019001\", \"2019003\", \"2019004\"],\n",
    "                   \"학과\" : [\"컴퓨터\", \"철학\", \"수학\"]})\n",
    "\n",
    "print(pd.merge(df1, df2, on=\"학번\", how=\"inner\"))   \n",
    "# 두 개의 DataFrame 결합시키기\n",
    "# on=\"학번\" : \"학번\"을 기준으로 결합!\n",
    "# how=\"inner\" : \"학번\"이 '공통'인 것만 뽑아서 결합!\n",
    "print(pd.merge(df1, df2, on=\"학번\", how=\"outer\")) # 모두 결합\n",
    "print(pd.merge(df1, df2, on=\"학번\", how=\"left\"))  # 왼쪽을 기준으로 NaN 값 줄 삭제\n",
    "print(pd.merge(df1, df2, on=\"학번\", how=\"right\")) # 오른쪽을 기준으로 NaN 값 줄 삭제 \n",
    "\n",
    "\n",
    "# df1 = pd.DataFrame({\"학번\" : [\"2019001\", \"2019002\", \"2019003\"],\n",
    "#                    \"이름\" : [\"이지안\", \"박동훈\", \"홍길동\"]})\n",
    "\n",
    "# df2 = pd.DataFrame({\"학생학번\" : [\"2019001\", \"2019003\", \"2019004\"],\n",
    "#                    \"학과\" : [\"컴퓨터\", \"철학\", \"수학\"]})\n",
    "\n",
    "# print(pd.merge(df1, df2, left_on=\"학번\", right_on=\"학생학번\", how=\"inner\"))\n",
    "# 내용은 같지만 column 이름이 다를 때\n",
    "\n",
    "# df1 = pd.DataFrame({\"학번\" : [\"2019001\", \"2019002\", \"2019003\"],\n",
    "#                    \"이름\" : [\"이지안\", \"박동훈\", \"홍길동\"]})\n",
    "# \n",
    "# df2 = pd.DataFrame({\"학과\" : [\"컴퓨터\", \"철학\", \"수학\"]},\n",
    "#                    index=[\"2019001\", \"2019003\", \"2019004\"])\n",
    "# \n",
    "# print(pd.merge(df1, df2, left_on=\"학번\", right_index=True, how=\"inner\"))\n",
    "# # df1은 \"학번\", df2는 index로 되어있을 때\n"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python [conda env:asus_env]",
   "language": "python",
   "name": "conda-env-asus_env-py"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.5.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
