{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# MovieLens Data Set을 이용 ( numpy 할 때 실습한 문제 )\n",
    "\n",
    "# 1.전체 영화에 대한 평균 평점은 얼마?\n",
    "# 2.각 사용자별 평균 평점을 구하세요\n",
    "# 3.각 영화별 평균 평점을 구하세요\n",
    "# 4.가장 평균 평점이 놓은 영화의 제목은 무엇인가요?\n",
    "#      (동률이 있으면 모두 출력하세요)\n",
    "# 5.comedy 영화 중 평점이 가장 낮은 영화의 제목은?\n",
    "# 6.2015년도에 평가된 모든 Romance 영화의 평균 평점은?\n",
    "#   timestamp : 1970년 1월 1일 0시 1초 -> 1 \n",
    "# 7.2014년도에 평가된 Action 영화의 평점을 기준으로 \n",
    "#   상위 10위까지 영화 제목 출력 (영화 제목, 오름차순 기준)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "3.501556983616962"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# 1.전체 영화에 대한 평균 평점은 얼마?\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "\n",
    "R = pd.read_csv(\"./data\\movie/ratings.csv\", delimiter=\",\")\n",
    "M = pd.read_csv(\"./data/movie/movies.csv\", delimiter=\",\")\n",
    "ratings = pd.DataFrame(R)\n",
    "movies = pd.DataFrame(M)\n",
    "\n",
    "display(ratings[\"rating\"].mean())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "# 2.각 사용자별 평균 평점을 구하세요.\n",
    "ratings = pd.DataFrame(R)\n",
    "\n",
    "userId_list = list( ratings[\"userId\"].unique() )\n",
    "average = list()\n",
    "for i in userId_list:\n",
    "    _userId = ratings[\"userId\"] == i\n",
    "    average.append(ratings.loc[ _userId, \"rating\"].mean())\n",
    "user_rating = pd.DataFrame({\"userId\": userId_list ,\n",
    "                        \"ratings\" : average})\n",
    "# display(df)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "# 3.각 영화별 평균 평점을 구하세요\n",
    "ratings = pd.DataFrame(R)\n",
    "\n",
    "movieId_list = list(ratings[\"movieId\"].unique())\n",
    "average = list()\n",
    "for a in movieId_list:\n",
    "    _movieId = ratings[\"movieId\"]==a\n",
    "    average.append(ratings.loc[_movieId, \"rating\"].mean())\n",
    "m_rating = pd.DataFrame( {\"movieId\" : movieId_list,\n",
    "                   \"ratings\" : average})\n",
    "    \n",
    "# display(m_rating)\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "# 4.가장 평균 평점이 놓은 영화의 제목은 무엇인가요?\n",
    "#      (동률이 있으면 모두 출력하세요)\n",
    "\n",
    "max_m_rating = m_rating.loc\\\n",
    "[m_rating[\"ratings\"] == m_rating[\"ratings\"].max()]\n",
    "new_movie = movies[[\"movieId\", \"title\"]]\n",
    "\n",
    "# display(pd.merge(max_m_rating, new_movie, on = \"movieId\", how=\"inner\"))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 106,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>movieId</th>\n",
       "      <th>title</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>1</td>\n",
       "      <td>Toy Story (1995)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>245</th>\n",
       "      <td>3</td>\n",
       "      <td>Grumpier Old Men (1995)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>552</th>\n",
       "      <td>231</td>\n",
       "      <td>Dumb &amp; Dumber (Dumb and Dumber) (1994)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>794</th>\n",
       "      <td>296</td>\n",
       "      <td>Pulp Fiction (1994)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>823</th>\n",
       "      <td>296</td>\n",
       "      <td>Pulp Fiction (1994)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1120</th>\n",
       "      <td>356</td>\n",
       "      <td>Forrest Gump (1994)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1493</th>\n",
       "      <td>367</td>\n",
       "      <td>Mask, The (1994)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1706</th>\n",
       "      <td>500</td>\n",
       "      <td>Mrs. Doubtfire (1993)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1769</th>\n",
       "      <td>543</td>\n",
       "      <td>So I Married an Axe Murderer (1993)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2029</th>\n",
       "      <td>673</td>\n",
       "      <td>Space Jam (1996)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2031</th>\n",
       "      <td>673</td>\n",
       "      <td>Space Jam (1996)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2065</th>\n",
       "      <td>673</td>\n",
       "      <td>Space Jam (1996)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2178</th>\n",
       "      <td>1073</td>\n",
       "      <td>Willy Wonka &amp; the Chocolate Factory (1971)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2242</th>\n",
       "      <td>1073</td>\n",
       "      <td>Willy Wonka &amp; the Chocolate Factory (1971)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2326</th>\n",
       "      <td>1080</td>\n",
       "      <td>Monty Python's Life of Brian (1979)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2447</th>\n",
       "      <td>1136</td>\n",
       "      <td>Monty Python and the Holy Grail (1975)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3079</th>\n",
       "      <td>1278</td>\n",
       "      <td>Young Frankenstein (1974)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3393</th>\n",
       "      <td>1580</td>\n",
       "      <td>Men in Black (a.k.a. MIB) (1997)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3464</th>\n",
       "      <td>1580</td>\n",
       "      <td>Men in Black (a.k.a. MIB) (1997)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3527</th>\n",
       "      <td>1732</td>\n",
       "      <td>Big Lebowski, The (1998)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3529</th>\n",
       "      <td>1732</td>\n",
       "      <td>Big Lebowski, The (1998)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3574</th>\n",
       "      <td>1732</td>\n",
       "      <td>Big Lebowski, The (1998)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3590</th>\n",
       "      <td>1732</td>\n",
       "      <td>Big Lebowski, The (1998)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3607</th>\n",
       "      <td>1732</td>\n",
       "      <td>Big Lebowski, The (1998)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3670</th>\n",
       "      <td>1777</td>\n",
       "      <td>Wedding Singer, The (1998)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3943</th>\n",
       "      <td>2054</td>\n",
       "      <td>Honey, I Shrunk the Kids (1989)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3945</th>\n",
       "      <td>2054</td>\n",
       "      <td>Honey, I Shrunk the Kids (1989)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4088</th>\n",
       "      <td>2174</td>\n",
       "      <td>Beetlejuice (1988)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4324</th>\n",
       "      <td>2450</td>\n",
       "      <td>Howard the Duck (1986)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4331</th>\n",
       "      <td>2450</td>\n",
       "      <td>Howard the Duck (1986)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37599</th>\n",
       "      <td>6827</td>\n",
       "      <td>It's Pat (1994)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37630</th>\n",
       "      <td>31422</td>\n",
       "      <td>Are We There Yet? (2005)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37730</th>\n",
       "      <td>4471</td>\n",
       "      <td>Arthur 2: On the Rocks (1988)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37780</th>\n",
       "      <td>26095</td>\n",
       "      <td>Carabineers, The (Carabiniers, Les) (1963)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37783</th>\n",
       "      <td>85334</td>\n",
       "      <td>Hard Ticket to Hawaii (1987)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37816</th>\n",
       "      <td>7834</td>\n",
       "      <td>After the Thin Man (1936)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37843</th>\n",
       "      <td>8387</td>\n",
       "      <td>Police Academy: Mission to Moscow (1994)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37844</th>\n",
       "      <td>8387</td>\n",
       "      <td>Police Academy: Mission to Moscow (1994)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37846</th>\n",
       "      <td>8387</td>\n",
       "      <td>Police Academy: Mission to Moscow (1994)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37855</th>\n",
       "      <td>72696</td>\n",
       "      <td>Old Dogs (2009)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37859</th>\n",
       "      <td>88356</td>\n",
       "      <td>Smurfs, The (2011)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37863</th>\n",
       "      <td>104076</td>\n",
       "      <td>Smurfs 2, The (2013)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38027</th>\n",
       "      <td>4125</td>\n",
       "      <td>Leonard Part 6 (1987)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38057</th>\n",
       "      <td>4721</td>\n",
       "      <td>American Outlaws (2001)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38403</th>\n",
       "      <td>151315</td>\n",
       "      <td>Ride Along 2 (2016)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38437</th>\n",
       "      <td>8620</td>\n",
       "      <td>Exterminating Angel, The (Ángel exterminador, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38592</th>\n",
       "      <td>25850</td>\n",
       "      <td>Holiday (1938)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38618</th>\n",
       "      <td>8632</td>\n",
       "      <td>Secret Society (2002)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38644</th>\n",
       "      <td>87413</td>\n",
       "      <td>Bernie (1996)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38663</th>\n",
       "      <td>84847</td>\n",
       "      <td>Emma (2009)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38676</th>\n",
       "      <td>135216</td>\n",
       "      <td>The Star Wars Holiday Special (1978)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38677</th>\n",
       "      <td>141994</td>\n",
       "      <td>Saving Christmas (2014)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38683</th>\n",
       "      <td>91414</td>\n",
       "      <td>Arthur Christmas (2011)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38770</th>\n",
       "      <td>25782</td>\n",
       "      <td>Boudu Saved From Drowning (Boudu sauvé des eau...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38772</th>\n",
       "      <td>92681</td>\n",
       "      <td>Journey 2: The Mysterious Island (2012)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38774</th>\n",
       "      <td>122246</td>\n",
       "      <td>Tooth Fairy 2 (2012)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38818</th>\n",
       "      <td>2586</td>\n",
       "      <td>Goodbye Lover (1999)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38844</th>\n",
       "      <td>6557</td>\n",
       "      <td>Born to Be Wild (1995)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38881</th>\n",
       "      <td>27595</td>\n",
       "      <td>Jesus Christ Vampire Hunter (2001)</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38902</th>\n",
       "      <td>44243</td>\n",
       "      <td>Leprechaun 4: In Space (1997)</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>632 rows × 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       movieId                                              title\n",
       "26           1                                   Toy Story (1995)\n",
       "245          3                            Grumpier Old Men (1995)\n",
       "552        231             Dumb & Dumber (Dumb and Dumber) (1994)\n",
       "794        296                                Pulp Fiction (1994)\n",
       "823        296                                Pulp Fiction (1994)\n",
       "1120       356                                Forrest Gump (1994)\n",
       "1493       367                                   Mask, The (1994)\n",
       "1706       500                              Mrs. Doubtfire (1993)\n",
       "1769       543                So I Married an Axe Murderer (1993)\n",
       "2029       673                                   Space Jam (1996)\n",
       "2031       673                                   Space Jam (1996)\n",
       "2065       673                                   Space Jam (1996)\n",
       "2178      1073         Willy Wonka & the Chocolate Factory (1971)\n",
       "2242      1073         Willy Wonka & the Chocolate Factory (1971)\n",
       "2326      1080                Monty Python's Life of Brian (1979)\n",
       "2447      1136             Monty Python and the Holy Grail (1975)\n",
       "3079      1278                          Young Frankenstein (1974)\n",
       "3393      1580                   Men in Black (a.k.a. MIB) (1997)\n",
       "3464      1580                   Men in Black (a.k.a. MIB) (1997)\n",
       "3527      1732                           Big Lebowski, The (1998)\n",
       "3529      1732                           Big Lebowski, The (1998)\n",
       "3574      1732                           Big Lebowski, The (1998)\n",
       "3590      1732                           Big Lebowski, The (1998)\n",
       "3607      1732                           Big Lebowski, The (1998)\n",
       "3670      1777                         Wedding Singer, The (1998)\n",
       "3943      2054                    Honey, I Shrunk the Kids (1989)\n",
       "3945      2054                    Honey, I Shrunk the Kids (1989)\n",
       "4088      2174                                 Beetlejuice (1988)\n",
       "4324      2450                             Howard the Duck (1986)\n",
       "4331      2450                             Howard the Duck (1986)\n",
       "...        ...                                                ...\n",
       "37599     6827                                    It's Pat (1994)\n",
       "37630    31422                           Are We There Yet? (2005)\n",
       "37730     4471                      Arthur 2: On the Rocks (1988)\n",
       "37780    26095         Carabineers, The (Carabiniers, Les) (1963)\n",
       "37783    85334                       Hard Ticket to Hawaii (1987)\n",
       "37816     7834                          After the Thin Man (1936)\n",
       "37843     8387           Police Academy: Mission to Moscow (1994)\n",
       "37844     8387           Police Academy: Mission to Moscow (1994)\n",
       "37846     8387           Police Academy: Mission to Moscow (1994)\n",
       "37855    72696                                    Old Dogs (2009)\n",
       "37859    88356                                 Smurfs, The (2011)\n",
       "37863   104076                               Smurfs 2, The (2013)\n",
       "38027     4125                              Leonard Part 6 (1987)\n",
       "38057     4721                            American Outlaws (2001)\n",
       "38403   151315                                Ride Along 2 (2016)\n",
       "38437     8620  Exterminating Angel, The (Ángel exterminador, ...\n",
       "38592    25850                                     Holiday (1938)\n",
       "38618     8632                              Secret Society (2002)\n",
       "38644    87413                                      Bernie (1996)\n",
       "38663    84847                                        Emma (2009)\n",
       "38676   135216               The Star Wars Holiday Special (1978)\n",
       "38677   141994                            Saving Christmas (2014)\n",
       "38683    91414                            Arthur Christmas (2011)\n",
       "38770    25782  Boudu Saved From Drowning (Boudu sauvé des eau...\n",
       "38772    92681            Journey 2: The Mysterious Island (2012)\n",
       "38774   122246                               Tooth Fairy 2 (2012)\n",
       "38818     2586                               Goodbye Lover (1999)\n",
       "38844     6557                             Born to Be Wild (1995)\n",
       "38881    27595                 Jesus Christ Vampire Hunter (2001)\n",
       "38902    44243                      Leprechaun 4: In Space (1997)\n",
       "\n",
       "[632 rows x 2 columns]"
      ]
     },
     "execution_count": 106,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# 5.comedy 영화 중 평점이 가장 낮은 영화의 제목은?\n",
    "# 1.comedy 영화만 뽑아내기\n",
    "# 2.comedy 영화 중 최저 평점을 알아내기\n",
    "# 3.최저 평점에 해당하는 영화 제목 뽑아내기\n",
    "\n",
    "ratings = pd.DataFrame(R)\n",
    "movies = pd.DataFrame(M)\n",
    "genres_list = list( gr for gr in movies[\"genres\"] ) # 모든 영화 장르 리스트로 만들기\n",
    "matching = [g for g in genres_list if \"Comedy\" in g]  # 영화 리스트 중 Comedy 포함 되는 것\n",
    "c_movie = movies.loc[movies[\"genres\"].isin(matching)]  # Comedy영화\n",
    "# movieId_rating = ratings[[\"movieId\", \"rating\"]] # inner join하기 위해 movieId와 rating 뽑기\n",
    "c_m_rating = pd.merge(ratings, c_movie, on=\"movieId\", how=\"inner\")\n",
    "# movieId를 기준으로 두 DataFrame 합치기\n",
    "c_m_rating.loc[c_m_rating[\"rating\"]==c_m_rating[\"rating\"].min(), [\"movieId\",\"title\"]]\n",
    "# 합쳐진 DataFrame에서 (이때 모든 영화는 Comedy 포함된 영화들) \n",
    "# 최저 평점과 같은 평점의 영화들의 제목 뽑기!\n",
    " #마지막에 최저 평점에 해당하는 영화 뽑아낼 때 코메디 중에서\n",
    "# 뽑아내야지 그냥 모든 영화를 기준으로 뽑아내면 안된다!!!"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 114,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "3.396375098502758"
      ]
     },
     "execution_count": 114,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# 6.2015년도에 평가된 모든 Romance 영화의 평균 평점은?\n",
    "#   timestamp : 1970년 1월 1일 0시 1초 -> 1\n",
    "# 1.로맨스 영화 뽑아내기\n",
    "#   로맨스 영화와 timestamp를 movieId로 inner join 하기\n",
    "# 2. 로맨스 영화 timestamp를 정렬하기\n",
    "# 3. 로맨스 영화 중 2015년에 평가된 영화 뽑아내기 (1420070400 ~1451606399에 평가된 영화들)\n",
    "# 4. 최저 평점 뽑아내기\n",
    "\n",
    "ratings = pd.DataFrame(R)\n",
    "movies = pd.DataFrame(M)\n",
    "genres_list = list( gr for gr in movies[\"genres\"] ) # 모든 영화 장르 리스트로 만들기\n",
    "matching = [R for R in genres_list if \"Romance\" in R]\n",
    "R_movies = movies[\"genres\"].isin(matching)  \n",
    "R_list = movies.loc[R_movies] #로맨스 영화 뽑기\n",
    "new_list =pd.merge(ratings, R_list, on=\"movieId\", how=\"inner\")\n",
    "\n",
    "df = new_list.sort_values(by=\"timestamp\")\n",
    "# 로맨스 영화에서 timestamp를 기준으로 오름차순 정렬\n",
    "R_2015 =df[(df[\"timestamp\"]>= 1420070400) & (df[\"timestamp\"] <= 1451606399)]\n",
    "# display(R_2015.loc[R_2015[\"rating\"]==R_2015[\"rating\"].min(),\\\n",
    "#                  [\"movieId\",\"title\"]])\n",
    "R_2015[\"rating\"].mean()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'pd' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[1;32m<ipython-input-1-0f53aea6e078>\u001b[0m in \u001b[0;36m<module>\u001b[1;34m()\u001b[0m\n\u001b[0;32m      6\u001b[0m \u001b[1;31m# 4. 그 중 상위 10위까지 영화 제목 출력하기\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m      7\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m----> 8\u001b[1;33m \u001b[0mratings\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mpd\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mDataFrame\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mR\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m      9\u001b[0m \u001b[0mmovies\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mpd\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mDataFrame\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mM\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     10\u001b[0m \u001b[0mgenres_list\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mlist\u001b[0m\u001b[1;33m(\u001b[0m \u001b[0mgr\u001b[0m \u001b[1;32mfor\u001b[0m \u001b[0mgr\u001b[0m \u001b[1;32min\u001b[0m \u001b[0mmovies\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;34m\"genres\"\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m)\u001b[0m \u001b[1;31m# 모든 영화 장르 리스트로 만들기\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;31mNameError\u001b[0m: name 'pd' is not defined"
     ]
    }
   ],
   "source": [
    "# 7.2014년도에 평가된 Action 영화의 평점을 기준으로 \n",
    "#   상위 10위까지 영화 제목 출력 (영화 제목, 오름차순 기준)\n",
    "# 1. 액션영화 뽑아내기\n",
    "# 2. 조인해서 DataFrame 만들기\n",
    "# 3. 액션영화들 중 2014년도에 평가된 영화 뽑아내기 (1388534400~1420070399)\n",
    "# 4. 그 중 상위 10위까지 영화 제목 출력하기 \n",
    "\n",
    "ratings = pd.DataFrame(R)\n",
    "movies = pd.DataFrame(M)\n",
    "genres_list = list( gr for gr in movies[\"genres\"] ) # 모든 영화 장르 리스트로 만들기\n",
    "matching = [A for A in genres_list if \"Action\" in A]\n",
    "A_movies = movies[\"genres\"].isin(matching)  \n",
    "A_list = movies.loc[A_movies] \n",
    "new_list =pd.merge(ratings, A_list, on=\"movieId\", how=\"inner\")\n",
    "\n",
    "A_2014 = new_list[(new_list[\"timestamp\"] >= 1388534400) \\\n",
    "                             & (new_list[\"timestamp\"] <= 1420070399) ]\n",
    "#                   2014년도에 평가된 액션영화\n",
    "\n",
    "\n",
    "\n",
    "_A_2014 = A_2014.sort_values(by=\"rating\")\n",
    "_A_2014.index = range(496)\n",
    "display(_A_2014.loc[0:9, \"title\"])s"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python [conda env:asus_env]",
   "language": "python",
   "name": "conda-env-asus_env-py"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.5.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
